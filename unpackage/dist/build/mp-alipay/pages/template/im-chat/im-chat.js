(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["pages/template/im-chat/im-chat"],{"024f":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("view",{staticClass:"uni-column",attrs:{_hid:0}},[n("view",{staticClass:"content",style:{height:t.style.contentViewHeight+"px"},attrs:{id:"content",_hid:1}},[n("scroll-view",{style:{height:t.style.contentViewHeight+"px"},attrs:{id:"scrollview","scroll-y":"true","scroll-with-animation":!0,"scroll-top":t.scrollTop,_hid:2,_batrs:"scroll-with-animation,scroll-top"}},[n("page-foot",{attrs:{name:t.name,_hid:3,_batrs:"name",_cid:0}}),t._l(t.messages,function(t,e,i){var s=void 0!==i?i:e;return n("message-show",{key:e,attrs:{message:t,id:e,_hid:1005,_fid:s,_batrs:"message,id",_fk:"index",_cid:1}})},1005,t._self),n("view",{attrs:{id:"bottom",_hid:2007}})],1)],1),n("view",{staticClass:"foot",attrs:{_hid:2008}},[n("chat-input",{attrs:{_hid:2009,_cid:2},on:{"send-message":t.getInputMessage,focus:t.inputGetFocus}})],1)])},s=[];n.d(e,"a",function(){return i}),n.d(e,"b",function(){return s})},"1c0f":function(t,e,n){},"2ff0":function(t,e,n){"use strict";n.r(e);var i=n("43c3"),s=n("b41b");for(var a in s)"default"!==a&&function(t){n.d(e,t,function(){return s[t]})}(a);n("4a99");var o=n("2877"),u=Object(o["a"])(s["default"],i["a"],i["b"],!1,null,null,null);e["default"]=u.exports},"338aa":function(t,e,n){"use strict";n("0055");var i=a(n("9df8")),s=a(n("3a53"));function a(t){return t&&t.__esModule?t:{default:t}}i.default.mpType="page";var o=new s.default(i.default);o.$mount()},"43c3":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("view",{staticClass:"footer",attrs:{_hid:0}},[n("view",{staticClass:"footer-left",attrs:{_hid:1}},[n("view",{staticClass:"uni-icon uni-icon-mic",attrs:{_hid:2},on:{tap:t.startRecognize}})]),n("view",{staticClass:"footer-center",attrs:{_hid:3}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"}],staticClass:"input-text",attrs:{type:"text",_hid:4},domProps:{value:t.inputValue},on:{input:function(e){e.target.composing||(t.inputValue=e.target.value)}}})]),n("view",{staticClass:"footer-right",attrs:{_hid:5},on:{tap:t.sendMessge}},[n("view",{attrs:{id:"msg-type",_hid:6}},[])])])},s=[];n.d(e,"a",function(){return i}),n.d(e,"b",function(){return s})},"4a99":function(t,e,n){"use strict";var i=n("5b39"),s=n.n(i);s.a},5767:function(t,e,n){"use strict";n.r(e);var i=n("a38b"),s=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,function(){return i[t]})}(a);e["default"]=s.a},"5b39":function(t,e,n){},7330:function(t,e,n){"use strict";var i=n("a9d7"),s=n.n(i);s.a},"999e":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("view",{staticClass:"m-item",attrs:{id:"message"+t.id,_hid:0,_batrs:"id"}},[n("view",{staticClass:"m-left",attrs:{_hid:1}},[t._ri(!("home"!=t.message.user),2)?n("image",{staticClass:"head_icon",attrs:{src:"https://img-cdn-qiniu.dcloud.net.cn/uniapp/app/homeHL.png",_hid:2}}):t._e()]),n("view",{staticClass:"m-content",attrs:{_hid:3}},[n("view",{staticClass:"m-content-head",class:{"m-content-head-right":"customer"==t.message.user},attrs:{_hid:4}},[n("view",{class:"m-content-head-"+t.message.user,attrs:{_hid:5}},[t._v(t._s(t.message.content),6)])])]),n("view",{staticClass:"m-right",attrs:{_hid:7}},[t._ri(!("customer"!=t.message.user),8)?n("image",{staticClass:"head_icon",attrs:{src:"https://img-cdn-qiniu.dcloud.net.cn/uniapp/app/customerHL.png",_hid:8}}):t._e()])])},s=[];n.d(e,"a",function(){return i}),n.d(e,"b",function(){return s})},"9df8":function(t,e,n){"use strict";n.r(e);var i=n("024f"),s=n("f7f8");for(var a in s)"default"!==a&&function(t){n.d(e,t,function(){return s[t]})}(a);n("7330");var o=n("2877"),u=Object(o["a"])(s["default"],i["a"],i["b"],!1,null,null,null);e["default"]=u.exports},a38b:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={props:["message","id"]};e.default=i},a9d7:function(t,e,n){},abeb:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(n("2ff0")),s=a(n("bb8d"));function a(t){return t&&t.__esModule?t:{default:t}}var o={data:function(){return{name:"xcecd@qq.com",style:{pageHeight:0,contentViewHeight:0,footViewHeight:90,mitemHeight:0},scrollTop:0,messages:[{user:"home",type:"head",content:"你好!"}]}},components:{chatInput:i.default,messageShow:s.default},onLoad:function(){var e=t.getSystemInfoSync();this.style.pageHeight=e.windowHeight,this.style.contentViewHeight=e.windowHeight-t.getSystemInfoSync().screenWidth/750*100},methods:{getInputMessage:function(t){this.addMessage("customer",t.content,!1),this.toRobot(t.content)},addMessage:function(t,e,n,i){var s=this;s.messages.push({user:t,content:e,hasSub:n,subcontent:i})},scrollToBottom:function(){var e=this,n=t.createSelectorQuery();n.selectAll(".m-item").boundingClientRect(),n.select("#scrollview").boundingClientRect(),n.exec(function(t){e.style.mitemHeight=0,t[0].forEach(function(t){e.style.mitemHeight=e.style.mitemHeight+t.height+20}),e.style.mitemHeight>e.style.contentViewHeight&&(e.scrollTop=e.style.mitemHeight-e.style.contentViewHeight)})},toRobot:function(e){var n=this,i="http://www.tuling123.com/openapi/api";t.request({url:i,data:{key:"acfbca724ea1b5db96d2eef88ce677dc",info:e,userid:"uni-test"},success:function(t){console.log("s",t),n.addMessage("home",t.data.text,!1),n.scrollToBottom(),console.log("request success:"+t.data.text)},fail:function(e){console.log("request fail",e),t.showModal({content:e.errMsg,showCancel:!1})}})}}};e.default=o}).call(this,n("c11b")["default"])},b41b:function(t,e,n){"use strict";n.r(e);var i=n("b59c"),s=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,function(){return i[t]})}(a);e["default"]=s.a},b59c:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={name:"chat-input",data:function(){return{inputValue:""}},methods:{startRecognize:function(){var t={},e=this;t.engine="iFly",e.inputValue="",plus.speech.startRecognize(t,function(t){console.log(t),e.inputValue+=t},function(t){console.log("语音识别失败："+t.message)})},sendMessge:function(){var t=this;""==t.inputValue.trim()?t.inputValue="":(this.$emit("send-message",{type:"text",content:t.inputValue}),t.inputValue="")}}};e.default=i},bb8d:function(t,e,n){"use strict";n.r(e);var i=n("999e"),s=n("5767");for(var a in s)"default"!==a&&function(t){n.d(e,t,function(){return s[t]})}(a);n("e1b3");var o=n("2877"),u=Object(o["a"])(s["default"],i["a"],i["b"],!1,null,null,null);e["default"]=u.exports},e1b3:function(t,e,n){"use strict";var i=n("1c0f"),s=n.n(i);s.a},f7f8:function(t,e,n){"use strict";n.r(e);var i=n("abeb"),s=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,function(){return i[t]})}(a);e["default"]=s.a}},[["338aa","common/runtime","common/vendor"]]]);