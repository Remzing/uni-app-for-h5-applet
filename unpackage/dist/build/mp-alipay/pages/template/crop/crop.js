(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["pages/template/crop/crop"],{"0e65":function(t,e,o){"use strict";o.r(e);var i=o("dd7a"),a=o.n(i);for(var n in i)"default"!==n&&function(t){o.d(e,t,function(){return i[t]})}(n);e["default"]=a.a},"5d3e":function(t,e,o){"use strict";var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("view",{staticClass:"container",attrs:{_hid:0}},[o("view",{staticClass:"page-body uni-content-info",attrs:{_hid:1}},[o("view",{staticClass:"cropper-content",attrs:{_hid:2}},[t._ri(!!t.isShowImg,3)?o("view",{staticClass:"uni-corpper",style:"width:"+t.cropperInitW+"px;height:"+t.cropperInitH+"px;background:#000",attrs:{_hid:3}},[o("view",{staticClass:"uni-corpper-content",style:"width:"+t.cropperW+"px;height:"+t.cropperH+"px;left:"+t.cropperL+"px;top:"+t.cropperT+"px",attrs:{_hid:4}},[o("image",{style:"width:"+t.cropperW+"px;height:"+t.cropperH+"px",attrs:{src:t.imageSrc,_hid:5,_batrs:"src"}}),o("view",{staticClass:"uni-corpper-crop-box",style:"left:"+t.cutL+"px;top:"+t.cutT+"px;right:"+t.cutR+"px;bottom:"+t.cutB+"px",attrs:{_hid:6},on:{touchstart:function(e){return"button"in e||!t._k(e.keyCode,"stop",void 0,e.key,void 0)?t.contentStartMove(e):null},touchmove:function(e){return"button"in e||!t._k(e.keyCode,"stop",void 0,e.key,void 0)?t.contentMoveing(e):null},touchend:function(e){return"button"in e||!t._k(e.keyCode,"stop",void 0,e.key,void 0)?t.contentTouchEnd(e):null}}},[o("view",{staticClass:"uni-cropper-view-box",attrs:{_hid:7}},[o("view",{staticClass:"uni-cropper-dashed-h",attrs:{_hid:8}}),o("view",{staticClass:"uni-cropper-dashed-v",attrs:{_hid:9}}),o("view",{staticClass:"uni-cropper-line-t",attrs:{"data-drag":"top",_hid:10},on:{touchstart:function(e){return"button"in e||!t._k(e.keyCode,"stop",void 0,e.key,void 0)?t.dragStart(e):null},touchmove:function(e){return"button"in e||!t._k(e.keyCode,"stop",void 0,e.key,void 0)?t.dragMove(e):null}}}),o("view",{staticClass:"uni-cropper-line-r",attrs:{"data-drag":"right",_hid:11},on:{touchstart:function(e){return"button"in e||!t._k(e.keyCode,"stop",void 0,e.key,void 0)?t.dragStart(e):null},touchmove:function(e){return"button"in e||!t._k(e.keyCode,"stop",void 0,e.key,void 0)?t.dragMove(e):null}}}),o("view",{staticClass:"uni-cropper-line-b",attrs:{"data-drag":"bottom",_hid:12},on:{touchstart:function(e){return"button"in e||!t._k(e.keyCode,"stop",void 0,e.key,void 0)?t.dragStart(e):null},touchmove:function(e){return"button"in e||!t._k(e.keyCode,"stop",void 0,e.key,void 0)?t.dragMove(e):null}}}),o("view",{staticClass:"uni-cropper-line-l",attrs:{"data-drag":"left",_hid:13},on:{touchstart:function(e){return"button"in e||!t._k(e.keyCode,"stop",void 0,e.key,void 0)?t.dragStart(e):null},touchmove:function(e){return"button"in e||!t._k(e.keyCode,"stop",void 0,e.key,void 0)?t.dragMove(e):null}}}),o("view",{staticClass:"uni-cropper-point point-t",attrs:{"data-drag":"top",_hid:14},on:{touchstart:function(e){return"button"in e||!t._k(e.keyCode,"stop",void 0,e.key,void 0)?t.dragStart(e):null},touchmove:function(e){return"button"in e||!t._k(e.keyCode,"stop",void 0,e.key,void 0)?t.dragMove(e):null}}}),o("view",{staticClass:"uni-cropper-point point-tr",attrs:{"data-drag":"topTight",_hid:15}}),o("view",{staticClass:"uni-cropper-point point-r",attrs:{"data-drag":"right",_hid:16},on:{touchstart:function(e){return"button"in e||!t._k(e.keyCode,"stop",void 0,e.key,void 0)?t.dragStart(e):null},touchmove:function(e){return"button"in e||!t._k(e.keyCode,"stop",void 0,e.key,void 0)?t.dragMove(e):null}}}),o("view",{staticClass:"uni-cropper-point point-rb",attrs:{"data-drag":"rightBottom",_hid:17},on:{touchstart:function(e){return"button"in e||!t._k(e.keyCode,"stop",void 0,e.key,void 0)?t.dragStart(e):null},touchmove:function(e){return"button"in e||!t._k(e.keyCode,"stop",void 0,e.key,void 0)?t.dragMove(e):null}}}),o("view",{staticClass:"uni-cropper-point point-b",attrs:{"data-drag":"bottom",_hid:18},on:{touchstart:function(e){return"button"in e||!t._k(e.keyCode,"stop",void 0,e.key,void 0)?t.dragStart(e):null},touchmove:function(e){return"button"in e||!t._k(e.keyCode,"stop",void 0,e.key,void 0)?t.dragMove(e):null},touchend:function(e){return"button"in e||!t._k(e.keyCode,"stop",void 0,e.key,void 0)?t.dragEnd(e):null}}}),o("view",{staticClass:"uni-cropper-point point-bl",attrs:{"data-drag":"bottomLeft",_hid:19}}),o("view",{staticClass:"uni-cropper-point point-l",attrs:{"data-drag":"left",_hid:20},on:{touchstart:function(e){return"button"in e||!t._k(e.keyCode,"stop",void 0,e.key,void 0)?t.dragStart(e):null},touchmove:function(e){return"button"in e||!t._k(e.keyCode,"stop",void 0,e.key,void 0)?t.dragMove(e):null}}}),o("view",{staticClass:"uni-cropper-point point-lt",attrs:{"data-drag":"leftTop",_hid:21}})])])])]):t._e()]),o("view",{staticClass:"cropper-config",attrs:{_hid:22}},[o("button",{staticStyle:{"margin-top":"30rpx"},attrs:{type:"primary reverse",_hid:23},on:{click:t.getImage}},[]),o("button",{staticStyle:{"margin-top":"30rpx"},attrs:{type:"warn",_hid:25},on:{click:t.getImageInfo}},[])],1),o("canvas",{style:"position:absolute;border: 1px solid red; width:"+t.imageW+"px;height:"+t.imageH+"px;top:-9999px;left:-9999px;",attrs:{"canvas-id":"myCanvas",_hid:27}})]),o("page-foot",{attrs:{name:t.name,_hid:28,_batrs:"name",_cid:0}})],1)},a=[];o.d(e,"a",function(){return i}),o.d(e,"b",function(){return a})},"69dc":function(t,e,o){},a64d:function(t,e,o){"use strict";o("0055");var i=n(o("cec8")),a=n(o("3a53"));function n(t){return t&&t.__esModule?t:{default:t}}i.default.mpType="page";var r=new a.default(i.default);r.$mount()},b494:function(t,e,o){"use strict";var i=o("69dc"),a=o.n(i);a.a},cec8:function(t,e,o){"use strict";o.r(e);var i=o("5d3e"),a=o("0e65");for(var n in a)"default"!==n&&function(t){o.d(e,t,function(){return a[t]})}(n);o("b494");var r=o("2877"),c=Object(r["a"])(a["default"],i["a"],i["b"],!1,null,null,null);e["default"]=c.exports},dd7a:function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o,i,a,n,r,c,u,s,d,p,h,l=t.getSystemInfoSync(),v=l.screenWidth,g=(l.pixelRatio,1),f=100,k=l.screenWidth,m={data:function(){return{name:"杨大宝",imageSrc:"https://img-cdn-qiniu.dcloud.net.cn/demo_crop.jpg",isShowImg:!1,cropperInitW:v,cropperInitH:v,cropperW:v,cropperH:v,cropperL:0,cropperT:0,transL:0,transT:0,scaleP:0,imageW:0,imageH:0,cutL:0,cutT:0,cutB:v,cutR:"100%",qualityWidth:k,innerAspectRadio:g}},onLoad:function(t){},mounted:function(){this.loadImage()},methods:{setData:function(t){var e=this;Object.keys(t).forEach(function(o){e.$set(e.$data,o,t[o])})},getImage:function(){var e=this;t.chooseImage({success:function(t){e.setData({imageSrc:t.tempFilePaths[0]}),e.loadImage()}})},loadImage:function(){var e=this;t.showLoading({title:"图片加载中..."}),t.getImageInfo({src:e.imageSrc,success:function(o){d=o.width/o.height,d>=1?(p=v,h=v/d):(p=v*d,h=v);var i=p>h?p:h;if(f=i>f?f:i,d>=1){var a=Math.ceil((v/d-(v/d-f))/2),n=a,r=Math.ceil((v-v+f)/2),c=r;e.setData({cropperW:v,cropperH:v/d,cropperL:Math.ceil((v-v)/2),cropperT:Math.ceil((v-v/d)/2),cutL:r,cutT:a,cutR:c,cutB:n,imageW:p,imageH:h,scaleP:p/v,qualityWidth:k,innerAspectRadio:d})}else{var u=Math.ceil((v*d-v*d)/2),s=u,l=Math.ceil((v-f)/2),g=l;e.setData({cropperW:v*d,cropperH:v,cropperL:Math.ceil((v-v*d)/2),cropperT:Math.ceil((v-v)/2),cutL:u,cutT:l,cutR:s,cutB:g,imageW:p,imageH:h,scaleP:p/v,qualityWidth:k,innerAspectRadio:d})}e.setData({isShowImg:!0}),t.hideLoading()}})},contentStartMove:function(t){o=t.touches[0].pageX,i=t.touches[0].pageY},contentMoveing:function(t){var e=(o-t.touches[0].pageX)*g,a=(i-t.touches[0].pageY)*g;e>0?this.cutL-e<0&&(e=this.cutL):this.cutR+e<0&&(e=-this.cutR),a>0?this.cutT-a<0&&(a=this.cutT):this.cutB+a<0&&(a=-this.cutB),this.setData({cutL:this.cutL-e,cutT:this.cutT-a,cutR:this.cutR+e,cutB:this.cutB+a}),o=t.touches[0].pageX,i=t.touches[0].pageY},contentTouchEnd:function(){},getImageInfo:function(){var e=this;t.showLoading({title:"图片生成中..."});var o=t.createCanvasContext("myCanvas");o.drawImage(e.imageSrc,0,0,p,h),o.draw(!0,function(){var o=(e.cropperW-e.cutL-e.cutR)/e.cropperW*p,i=(e.cropperH-e.cutT-e.cutB)/e.cropperH*h,a=e.cutL/e.cropperW*p,n=e.cutT/e.cropperH*h;t.canvasToTempFilePath({x:a,y:n,width:o,height:i,destWidth:o,destHeight:i,quality:.5,canvasId:"myCanvas",success:function(e){t.hideLoading(),t.previewImage({current:"",urls:[e.tempFilePath]})}})})},dragStart:function(t){a=t.touches[0].pageX,n=t.touches[0].pageY,r=this.cutL,u=this.cutR,s=this.cutB,c=this.cutT},dragMove:function(t){var e=t.target.dataset.drag;switch(e){case"right":var o=(a-t.touches[0].pageX)*g;u+o<0&&(o=-u),this.setData({cutR:u+o});break;case"left":o=(a-t.touches[0].pageX)*g;r-o<0&&(o=r),r-o>this.cropperW-this.cutR&&(o=r-(this.cropperW-this.cutR)),this.setData({cutL:r-o});break;case"top":o=(n-t.touches[0].pageY)*g;c-o<0&&(o=c),c-o>this.cropperH-this.cutB&&(o=c-(this.cropperH-this.cutB)),this.setData({cutT:c-o});break;case"bottom":o=(n-t.touches[0].pageY)*g;s+o<0&&(o=-s),this.setData({cutB:s+o});break;case"rightBottom":var i=(a-t.touches[0].pageX)*g,d=(n-t.touches[0].pageY)*g;s+d<0&&(d=-s),u+i<0&&(i=-u);var p=s+d,h=u+i;this.setData({cutB:p,cutR:h});break;default:break}}}};e.default=m}).call(this,o("c11b")["default"])}},[["a64d","common/runtime","common/vendor"]]]);